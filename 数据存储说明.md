# Deep360 数据存储说明

## 📊 数据存储架构

### 1. 代码文件存储
- **位置**: GitHub 仓库
- **内容**: 源代码、配置文件、文档
- **备份**: Git 版本控制自动备份
- **同步**: 多开发者协作

### 2. 数据库存储
- **位置**: MongoDB (服务器: 74.208.61.148)
- **内容**: 用户数据、账号信息、任务记录
- **备份**: 自动备份到 `/root/m360_backup_YYYY-MM-DD/`
- **恢复**: `mongorestore` 命令

### 3. 文件存储
- **位置**: 服务器本地文件系统
- **内容**: 上传文件、日志、临时文件
- **备份**: 包含在系统备份中
- **路径**: `/opt/messenger360/uploads/`

### 4. 配置存储
- **位置**: 服务器环境变量和配置文件
- **内容**: API密钥、数据库连接、服务配置
- **备份**: 手动备份，不存储在Git中
- **安全**: 敏感信息加密存储

## 🔄 数据同步策略

### 代码同步
```bash
# 推送到 GitHub
git add .
git commit -m "更新功能"
git push origin main

# 从 GitHub 拉取
git pull origin main
```

### 数据库同步
```bash
# 备份数据库
mongodump --db messenger360 --out /backup/

# 恢复数据库
mongorestore --db messenger360 /backup/messenger360/
```

### 文件同步
```bash
# 备份上传文件
tar -czf uploads_backup.tar.gz /opt/messenger360/uploads/

# 恢复上传文件
tar -xzf uploads_backup.tar.gz -C /opt/messenger360/
```

## 🛡️ 数据安全

### 敏感数据保护
- **环境变量**: 存储在 `.env` 文件中（不提交到Git）
- **API密钥**: 加密存储在数据库中
- **用户密码**: bcrypt 加密存储
- **会话信息**: JWT token 管理

### 备份策略
- **自动备份**: 每日自动备份到 `/root/m360_backup_YYYY-MM-DD/`
- **手动备份**: 重要更新前手动备份
- **异地备份**: 定期同步到其他服务器

## 📋 当前数据状态

### 已部署的服务
- **前端**: http://74.208.61.148/
- **后端API**: http://74.208.61.148/api/
- **数据库**: MongoDB (messenger360)
- **进程管理**: PM2

### 数据存储位置
- **代码**: 本地文件系统 + GitHub（待设置）
- **数据库**: MongoDB 服务器
- **日志**: `/opt/messenger360/logs/`
- **上传**: `/opt/messenger360/uploads/`

## 🚀 下一步操作

### 1. 设置 GitHub 仓库
```bash
# 运行设置脚本
powershell -ExecutionPolicy Bypass -File setup-git.ps1

# 在 GitHub 上创建仓库后
git remote add origin https://github.com/your-username/deep360.git
git push -u origin main
```

### 2. 配置环境变量
```bash
# 复制环境配置模板
cp env.example .env

# 编辑配置文件
nano .env
```

### 3. 启动本地开发环境
```bash
# 安装依赖
npm install

# 启动开发服务器
npm run dev
```

## ⚠️ 注意事项

1. **敏感信息**: 不要将 `.env` 文件提交到 Git
2. **大文件**: 避免将大文件（如ISO、RAR）提交到 Git
3. **数据库**: 定期备份 MongoDB 数据
4. **日志**: 定期清理日志文件避免占用过多空间
5. **权限**: 确保文件权限正确设置

## 📞 技术支持

如果遇到数据存储问题，请检查：
1. MongoDB 服务状态
2. 磁盘空间使用情况
3. 文件权限设置
4. 网络连接状态 